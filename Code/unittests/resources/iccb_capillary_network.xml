<?xml version="1.0" ?>
<hemelbsettings version="4">
  <simulation>
    <steps units="lattice" value="2000000" />
    <stresstype value="1" />
    
    <!-- min 10 sites -->
    <step_length units="s" value="2.940672e-08" />  <!-- delta_t for tau=1.2 and delta_x=3.88889e-07m -->
    <voxel_size units="m" value="3.88889e-07" />
    <origin units="m" value="(1.26226089303e-05,9.58874616141e-06,-1.12766943408e-05)" />
    
    <!-- min 5 sites -->
    <!-- <step_length units="s" value="1.488715e-07" /> --> <!-- delta_t for tau=1.2 and delta_x=8.75e-07m -->
    <!-- <voxel_size units="m" value="8.75e-07" /> -->
    <!-- <origin units="m" value="(1.2574028194e-05,9.44294101e-06,-1.13739131093e-05)" /> -->
    
    <!-- min 3 sites -->
    <!-- <step_length units="s" value="2.552083e-07" /> --> <!-- delta_t for tau=0.8 -->
    <!-- <voxel_size units="m" value="1.75e-06" /> -->
    <!-- <origin units="m" value="(1.2136528194e-05,9.00544101e-06,-1.13739131093e-05)" /> -->    
  </simulation>
  
  <geometry>
    <datafile path="P6_190514_x63x0.6_0_RED_BW_corrected_tubed_smoothed_0_388889_1000_3.gmy" /> <!-- min 10 sites -->
    <!-- <datafile path="P6_190514_x63x0.6_0_RED_BW_corrected_tubed_smoothed_0_875_1000_3.gmy" /> --> <!-- min 5 sites -->
    <!-- <datafile path="P6_190514_x63x0.6_0_RED_BW_corrected_tubed_smoothed_1_75_1000_3.gmy" /> --> <!-- min 3 sites -->
  </geometry>
  
  <inlets>
    <inlet>
      <condition subtype="parabolic" type="velocity">      
        <radius units="m" value="9.5e-6" />
        <maximum units="m/s" value="20e-3" />
      </condition>
      <normal units="dimensionless" value="(0.0676185870138,0.997184447299,0.0)" />
      <position units="m" value="(0.000148903942594,1.72330174871e-05,0.0)" />
      <flowextension>
        <length units="m" value="10e-6" />
        <radius units="m" value="9e-6" />
        <fadelength units="m" value="7e-06" />
      </flowextension>
      
      <insertcell template="default">
        <every units="s" value="0.9e-3"/>
        <offset units="s" value="40e-8"/>
        <x units="m" value="-5.75e-6"/>
        <y units="m" value="0"/>
        <delta_t units="s" value="0e0"/>
        <theta units="rad" value="0e0"/>
        <phi units="rad" value="0e0"/>
        <delta_theta units="rad" value="3.1416"/>
        <delta_phi units="rad" value="3.1416"/>
      </insertcell>      
      <insertcell template="default">
        <every units="s" value="0.9e-3"/>
        <offset units="s" value="40e-8"/>
        <x units="m" value="5.75e-6"/>
        <y units="m" value="0"/>
        <delta_t units="s" value="0e0"/>
        <theta units="rad" value="0e0"/>
        <phi units="rad" value="0e0"/>
        <delta_theta units="rad" value="3.1416"/>
        <delta_phi units="rad" value="3.1416"/>
      </insertcell>
      <insertcell template="default">
        <every units="s" value="0.9e-3"/>
        <offset units="s" value="40e-8"/>
        <x units="m" value="0"/>
        <y units="m" value="-5.75e-6"/>
        <delta_t units="s" value="0e0"/>
        <theta units="rad" value="0e0"/>
        <phi units="rad" value="0e0"/>
        <delta_theta units="rad" value="3.1416"/>
        <delta_phi units="rad" value="3.1416"/>
      </insertcell>      
      <insertcell template="default">
        <every units="s" value="0.9e-3"/>
        <offset units="s" value="40e-8"/>
        <x units="m" value="0"/>
        <y units="m" value="5.75e-6"/>
        <delta_t units="s" value="0e0"/>
        <theta units="rad" value="0e0"/>
        <phi units="rad" value="0e0"/>
        <delta_theta units="rad" value="3.1416"/>
        <delta_phi units="rad" value="3.1416"/>
      </insertcell>

      <insertcell template="default">
        <every units="s" value="0.35e-3"/>
        <offset units="s" value="40e-8"/>
        <x units="m" value="0"/>
        <y units="m" value="0"/>
        <delta_t units="s" value="0e0"/>
        <theta units="rad" value="0e0"/>
        <phi units="rad" value="0e0"/>
        <delta_theta units="rad" value="3.1416"/>
        <delta_phi units="rad" value="3.1416"/>
      </insertcell>      

      <insertcell template="default">
        <every units="s" value="0.9e-3"/>
        <offset units="s" value="0.45e-3"/>
        <x units="m" value="4.066e-6"/>
        <y units="m" value="4.066e-6"/>
        <delta_t units="s" value="0e0"/>
        <theta units="rad" value="0e0"/>
        <phi units="rad" value="0e0"/>
        <delta_theta units="rad" value="3.1416"/>
        <delta_phi units="rad" value="3.1416"/>
      </insertcell>      
      <insertcell template="default">
        <every units="s" value="0.9e-3"/>
        <offset units="s" value="0.45e-3"/>
        <x units="m" value="4.066e-6"/>
        <y units="m" value="-4.066e-6"/>
        <delta_t units="s" value="0e0"/>
        <theta units="rad" value="0e0"/>
        <phi units="rad" value="0e0"/>
        <delta_theta units="rad" value="3.1416"/>
        <delta_phi units="rad" value="3.1416"/>
      </insertcell>
      <insertcell template="default">
        <every units="s" value="0.9e-3"/>
        <offset units="s" value="0.45e-3"/>
        <x units="m" value="-4.066e-6"/>
        <y units="m" value="4.066e-6"/>
        <delta_t units="s" value="0e0"/>
        <theta units="rad" value="0e0"/>
        <phi units="rad" value="0e0"/>
        <delta_theta units="rad" value="3.1416"/>
        <delta_phi units="rad" value="3.1416"/>
      </insertcell>      
      <insertcell template="default">
        <every units="s" value="0.9e-3"/>
        <offset units="s" value="0.45e-3"/>
        <x units="m" value="-4.066e-6"/>
        <y units="m" value="-4.066e-6"/>
        <delta_t units="s" value="0e0"/>
        <theta units="rad" value="0e0"/>
        <phi units="rad" value="0e0"/>
        <delta_theta units="rad" value="3.1416"/>
        <delta_phi units="rad" value="3.1416"/>
      </insertcell>
    </inlet>
  </inlets>
  
  <outlets>
    <outlet>
      <condition subtype="cosine" type="pressure">
        <amplitude units="mmHg" value="0.0" />
        <mean units="mmHg" value="0.0" />
        <phase units="rad" value="0.0" />
        <period units="s" value="1" />
      </condition>
      <normal units="dimensionless" value="(0.948276136137,-0.317446640608,0.0)" />
      <position units="m" value="(1.41604021878e-05,0.000115758478581,0.0)" />
      <flowextension>
        <length units="m" value="10e-6" />
        <radius units="m" value="9e-6" />
        <fadelength units="m" value="8e-06" />
      </flowextension>      
    </outlet>
    <outlet>
      <condition subtype="cosine" type="pressure">
        <amplitude units="mmHg" value="0.0" />
        <mean units="mmHg" value="0.0" />
        <phase units="rad" value="0.0" />
        <period units="s" value="1" />
      </condition>
      <normal units="dimensionless" value="(0.820693962628,-0.571368024749,0.0)" />
      <position units="m" value="(4.55450800422e-05,0.000207129017315,0.0)" />
      <flowextension>
        <length units="m" value="10e-6" />
        <radius units="m" value="9e-6" />
        <fadelength units="m" value="8e-06" />
      </flowextension>      
    </outlet>
    <outlet>
      <condition subtype="cosine" type="pressure">
        <amplitude units="mmHg" value="0.0" />
        <mean units="mmHg" value="0.0" />
        <phase units="rad" value="0.0" />
        <period units="s" value="1" />
      </condition>
      <normal units="dimensionless" value="(-0.549252152188,-0.835656671916,4.71844785466e-16)" />
      <position units="m" value="(0.000124954094823,0.000207275883169,3.435015748e-08)" />
      <flowextension>
        <length units="m" value="18e-6" />
        <radius units="m" value="9e-6" />
        <fadelength units="m" value="8e-06" />
      </flowextension>
    </outlet>
  </outlets>

  <properties>
    <propertyoutput period="10000" file="wholegeometry_vel_pres_stress.dat">
      <geometry type="whole"/>
      <field type="velocity"/>
      <field type="pressure"/>
      <field type="shearrate"/>
      <field type="tangentialprojectiontraction"/>
    </propertyoutput>
    <propertyoutput period="10000" file="surface_stress.dat">
      <geometry type="surface"/>
      <field type="pressure"/>
      <field type="tangentialprojectiontraction"/>
    </propertyoutput>
    <propertyoutput period="1000" file="plane_vel_stress.dat">
      <geometry type="plane">
        <point units="m" value="(0.,0.,0.)" />
        <normal units="dimensionless" value="(0,0,1)" />
      </geometry>
      <field type="velocity"/>
      <field type="tangentialprojectiontraction"/>
    </propertyoutput>
  </properties>

  <visualisation>
    <centre units="m" value="(0.0,0.0,0.0)" />
    <orientation>
      <longitude units="deg" value="45.0" />
      <latitude units="deg" value="45.0" />
    </orientation>
    <display brightness="0.03" zoom="1.0" />
    <range>
      <maxvelocity units="m/s" value="0.1" />
      <maxstress units="Pa" value="0.1" />
    </range>
  </visualisation>
  
  <redbloodcells>
    <controller>
      <boxsize units="lattice" value="3" />
    </controller>
    <cell2Cell>
      <intensity units="lattice" value="2.554e-05" />
      <cutoffdistance units="lattice" value="1.0" />
      <exponent value="2"/>
    </cell2Cell>
    <cell2Wall>
      <intensity units="lattice" value="2.554e-5" />
      <cutoffdistance units="lattice" value="1.0" />
      <exponent value="2"/>
    </cell2Wall>
    <cells>
      <cell name="default">
        <moduli>
          <bending units="lattice" value="2.554e-05" />
          <surface units="lattice" value="1e0" />
          <volume units="lattice" value="1e0" />
          <dilation units="lattice" value="0.5" />
          <strain units="lattice" value="0.0002043" />
        </moduli>
        <shape mesh_path="rbc_ico_1280.msh" mesh_format="Krueger" />
        <scale units="m" value="2.75e-06" /> <!-- The radius of the template cell is 1, therefore the radius of the RBC will be equal to scale (RBC diameter typically 6.2-8.2um) -->
      </cell>
    </cells>
  </redbloodcells>
    
  <initialconditions>
    <pressure>
      <uniform units="mmHg" value="0.0" />
    </pressure>
  </initialconditions>
</hemelbsettings>
